{"version":3,"file":"static/js/1734.8eb904e4.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/libs/i3s/enums.js","../node_modules/@arcgis/core/libs/i3s/I3SModule.js","../node_modules/@arcgis/core/views/3d/layers/SceneLayerWorker.js","../node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nvar n,e;!function(n){n[n.None=0]=\"None\",n[n.Int16=1]=\"Int16\",n[n.Int32=2]=\"Int32\"}(n||(n={})),function(n){n[n.Replace=0]=\"Replace\",n[n.Outside=1]=\"Outside\",n[n.Inside=2]=\"Inside\",n[n.Finished=3]=\"Finished\"}(e||(e={}));export{n as IndexType,e as ModificationType};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as t}from\"../../assets.js\";function e(){return n||(n=new Promise((t=>import(\"../../chunks/i3s.js\").then((t=>t.i)).then((({default:e})=>{const n=e({locateFile:i,onRuntimeInitialized:()=>t(n)});delete n.then})))).catch((t=>{throw t}))),n}function i(e){return t(`esri/libs/i3s/${e}`)}let n;export{e as get};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport e from\"../../../geometry/SpatialReference.js\";import{toFloat64Array as r}from\"../../../geometry/support/DoubleArray.js\";import t from\"../../../geometry/support/MeshGeoreferencedRelativeVertexSpace.js\";import o from\"../../../geometry/support/MeshLocalVertexSpace.js\";import{a as n,n as s}from\"../../../chunks/vec32.js\";import{IndexType as i}from\"../../../libs/i3s/enums.js\";import{get as a}from\"../../../libs/i3s/I3SModule.js\";import{NodeIMModificationImpact as f}from\"./i3s/I3SNode.js\";async function l(e){g=await j();const r=[e.geometryBuffer];return{result:w(g,e,r),transferList:r}}async function c(e){g=await j();const r=[e.geometryBuffer],{geometryBuffer:t}=e,o=t.byteLength,n=g._malloc(o),s=new Uint8Array(g.HEAPU8.buffer,n,o);s.set(new Uint8Array(t));const i=g.dracoDecompressPointCloudData(n,s.byteLength);if(g._free(n),i.error.length>0)throw new Error(`i3s.wasm: ${i.error}`);const a=i.featureIds?.length>0?i.featureIds.slice():null,f=i.positions.slice();return a&&r.push(a.buffer),r.push(f.buffer),{result:{positions:f,featureIds:a},transferList:r}}async function u(e){await j(),L(e);const r={buffer:e.buffer};return{result:r,transferList:[r.buffer]}}async function m(e){await j(),E(e)}async function y(e){g=await j(),g.setLegacySchema(e.context,e.jsonSchema)}async function p(n){const{localMatrix:s,origin:i,positions:a,vertexSpace:f,localMode:l}=n,c=e.fromJSON(n.inSpatialReference),u=e.fromJSON(n.outSpatialReference);let m;if(\"georeferenced\"===f.type){const[{projectBuffer:e},{initializeProjection:r}]=await Promise.all([import(\"../../../geometry/projection/projectBuffer.js\"),import(\"../../../geometry/projection.js\")]);await r(c,u),m=new Float64Array(a.length),e(a,c,0,m,u,0,m.length/3)}else{const e=\"georeferencedRelative\"===f.type?t.fromJSON(f):o.fromJSON(f),{project:n}=await import(\"../../../geometry/support/meshUtils/georeference.js\");m=r(n({positions:a,transform:s?{localMatrix:s}:void 0,vertexSpace:e,inSpatialReference:c,outSpatialReference:u,localMode:l}))}const y=m.length,[p,d,b]=i;for(let e=0;e<y;e+=3)m[e]-=p,m[e+1]-=d,m[e+2]-=b;return{result:{projected:m,original:a},transferList:[m.buffer,a.buffer]}}async function d({normalMatrix:e,normals:r}){const t=new Float32Array(r.length);return n(t,r,e),s(t,t),{result:{transformed:t,original:r},transferList:[t.buffer,r.buffer]}}function b(e){S(e)}let h,g;function E(e){if(!g)return;const r=e.modifications,t=g._malloc(8*r.length),o=new Float64Array(g.HEAPU8.buffer,t,r.length);for(let n=0;n<r.length;++n)o[n]=r[n];g.setModifications(e.context,t,r.length,e.isGeodetic),g._free(t)}function w(e,r,t){const{context:o,localOrigin:n,globalTrafo:s,mbs:a,obb:f,elevationOffset:l,geometryBuffer:c,geometryDescriptor:u,indexToVertexProjector:m,vertexToRenderProjector:y}=r,p=e._malloc(c.byteLength),d=33,b=e._malloc(d*Float64Array.BYTES_PER_ELEMENT),h=new Uint8Array(e.HEAPU8.buffer,p,c.byteLength);h.set(new Uint8Array(c));const g=new Float64Array(e.HEAPU8.buffer,b,d);_(g,n);let E=g.byteOffset+3*g.BYTES_PER_ELEMENT,w=new Float64Array(g.buffer,E);_(w,s),E+=16*g.BYTES_PER_ELEMENT,w=new Float64Array(g.buffer,E),_(w,a),E+=4*g.BYTES_PER_ELEMENT,null!=f&&(w=new Float64Array(g.buffer,E),_(w,f.center),E+=3*g.BYTES_PER_ELEMENT,w=new Float64Array(g.buffer,E),_(w,f.halfSize),E+=3*g.BYTES_PER_ELEMENT,w=new Float64Array(g.buffer,E),_(w,f.quaternion));const A=u,L={isDraco:!1,isLegacy:!1,color:r.layouts.some((e=>e.some((e=>\"color\"===e.name)))),normal:r.needNormals&&r.layouts.some((e=>e.some((e=>\"normalCompressed\"===e.name)))),uv0:r.layouts.some((e=>e.some((e=>\"uv0\"===e.name)))),uvRegion:r.layouts.some((e=>e.some((e=>\"uvRegion\"===e.name)))),featureIndex:A.featureIndex},S=e.process(o,!!r.obb,p,h.byteLength,A,L,b,l,m,y,r.normalReferenceFrame);if(e._free(b),e._free(p),S.error.length>0)throw new Error(`i3s.wasm: ${S.error}`);if(S.discarded)return null;const I=S.componentOffsets.length>0?S.componentOffsets.slice():null,j=S.featureIds.length>0?S.featureIds.slice():null,M=S.anchorIds.length>0?Array.from(S.anchorIds):null,P=S.anchors.length>0?Array.from(S.anchors):null,T=S.interleavedVertedData.slice().buffer,x=S.indicesType===i.Int16?new Uint16Array(S.indices.buffer,S.indices.byteOffset,S.indices.byteLength/2).slice():new Uint32Array(S.indices.buffer,S.indices.byteOffset,S.indices.byteLength/4).slice(),R=S.positions.slice(),U=S.positionIndicesType===i.Int16?new Uint16Array(S.positionIndices.buffer,S.positionIndices.byteOffset,S.positionIndices.byteLength/2).slice():new Uint32Array(S.positionIndices.buffer,S.positionIndices.byteOffset,S.positionIndices.byteLength/4).slice(),v={layout:r.layouts[0],interleavedVertexData:T,indices:x,hasColors:S.hasColors,hasModifications:S.hasModifications,positionData:{data:R,indices:U}};return j&&t.push(j.buffer),I&&t.push(I.buffer),t.push(T),t.push(x.buffer),t.push(R.buffer),t.push(U.buffer),{componentOffsets:I,featureIds:j,anchorIds:M,anchors:P,transformedGeometry:v,obb:S.obb}}function A(e){return 0===e?f.Unmodified:1===e?f.PotentiallyModified:2===e?f.Culled:f.Unknown}function L(e){if(!g)return;const{context:r,buffer:t}=e,o=g._malloc(t.byteLength),n=t.byteLength/Float64Array.BYTES_PER_ELEMENT,s=new Float64Array(g.HEAPU8.buffer,o,n),i=new Float64Array(t);s.set(i),g.filterOBBs(r,o,n),i.set(s),g._free(o)}function S(e){g&&0===g.destroy(e)&&(g=null)}function _(e,r){for(let t=0;t<r.length;++t)e[t]=r[t]}async function I(){g||await j()}function j(){return g?Promise.resolve(g):(h||(h=a().then((e=>(g=e,h=null,g)))),h)}const M={transform:(e,r)=>g&&w(g,e,r),destroy:S};export{b as destroyContext,c as dracoDecompressPointCloudData,u as filterObbsForModifications,L as filterObbsForModificationsSync,I as initialize,A as interpretObbModificationResults,l as process,p as project,y as setLegacySchema,m as setModifications,E as setModificationsSync,M as test,d as transformNormals};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{f as e}from\"../../../../chunks/sphere.js\";class i{constructor(i,t){this.id=i,this.mbs=t,this.renderMbs=e(0,0,0,-1),this.elevationRangeMin=NaN,this.elevationRangeMax=NaN}invalidateElevationRange(){this.elevationRangeMin=NaN}}var t,n,o,a,s;!function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.Culled=1]=\"Culled\",e[e.NotChecked=2]=\"NotChecked\"}(t||(t={})),function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.PotentiallyModified=1]=\"PotentiallyModified\",e[e.Culled=2]=\"Culled\",e[e.Unknown=3]=\"Unknown\",e[e.NotChecked=4]=\"NotChecked\"}(n||(n={}));class h extends i{constructor(e,i,t,a,s,h,d,c,r,l){super(e,t),this.index=i,this.childCount=a,this.level=s,this.resources=h,this.version=d,this.lodMetric=c,this.maxError=r,this.numFeatures=l,this.failed=!1,this.cacheState=o.Unknown,this.vertexCount=0,this.memory=0,this.childrenLoaded=0,this.hasModifications=!1,this.imModificationImpact=n.NotChecked}}!function(e){e[e.Unknown=0]=\"Unknown\",e[e.Uncached=1]=\"Uncached\",e[e.Cached=2]=\"Cached\"}(o||(o={})),function(e){e[e.None=0]=\"None\",e[e.MaxScreenThreshold=1]=\"MaxScreenThreshold\",e[e.ScreenSpaceRelative=2]=\"ScreenSpaceRelative\",e[e.RemovedFeatureDiameter=3]=\"RemovedFeatureDiameter\",e[e.DistanceRangeFromDefaultCamera=4]=\"DistanceRangeFromDefaultCamera\"}(a||(a={})),function(e){e[e.Hole=0]=\"Hole\",e[e.Leaf=1]=\"Leaf\"}(s||(s={}));class d{constructor(e,i,t,n){this.nodeHasLOD=e,this.isChosen=i,this.lodLevel=t,this.version=n}}export{o as CacheState,a as LodMetric,h as Node,i as NodeBase,t as NodeFilterImpact,n as NodeIMModificationImpact,s as NodeState,d as NodeTraversalState};\n"],"names":["n","e","None","Int16","Int32","Replace","Outside","Inside","Finished","i","t","concat","async","l","g","j","r","geometryBuffer","result","w","transferList","c","_i$featureIds","o","byteLength","_malloc","s","Uint8Array","HEAPU8","buffer","set","dracoDecompressPointCloudData","_free","error","length","Error","a","featureIds","slice","f","positions","push","u","L","m","E","y","setLegacySchema","context","jsonSchema","p","localMatrix","origin","vertexSpace","localMode","fromJSON","inSpatialReference","outSpatialReference","type","projectBuffer","initializeProjection","Promise","all","Float64Array","project","transform","d","b","projected","original","_ref","normalMatrix","normals","Float32Array","transformed","S","h","modifications","setModifications","isGeodetic","localOrigin","globalTrafo","mbs","obb","elevationOffset","geometryDescriptor","indexToVertexProjector","vertexToRenderProjector","BYTES_PER_ELEMENT","_","byteOffset","center","halfSize","quaternion","A","isDraco","isLegacy","color","layouts","some","name","normal","needNormals","uv0","uvRegion","featureIndex","process","normalReferenceFrame","discarded","I","componentOffsets","M","anchorIds","Array","from","P","anchors","T","interleavedVertedData","x","indicesType","Uint16Array","indices","Uint32Array","R","U","positionIndicesType","positionIndices","v","layout","interleavedVertexData","hasColors","hasModifications","positionData","data","transformedGeometry","Unmodified","PotentiallyModified","Culled","Unknown","filterOBBs","destroy","resolve","then","default","locateFile","onRuntimeInitialized","catch","constructor","this","id","renderMbs","elevationRangeMin","NaN","elevationRangeMax","invalidateElevationRange","NotChecked","super","index","childCount","level","resources","version","lodMetric","maxError","numFeatures","failed","cacheState","vertexCount","memory","childrenLoaded","imModificationImpact","Uncached","Cached","MaxScreenThreshold","ScreenSpaceRelative","RemovedFeatureDiameter","DistanceRangeFromDefaultCamera","Hole","Leaf","nodeHasLOD","isChosen","lodLevel"],"sourceRoot":""}