{"version":3,"file":"static/js/1264.ad1c041b.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/sceneLayerSnappingUtils.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/SceneLayerSnappingSourceWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{q as s,o,g as r}from\"../../../../../chunks/vec3.js\";import{c,g as n}from\"../../../../../chunks/sphere.js\";const t=1e3;function e(t,e,a){const m=c(),p=n(m);return s(p,p,t,.5),s(p,p,e,.5),m[3]=o(p,t),r(p,p,a),m}export{e as boundsFromEdge,t as maxCandidateCount};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{throwIfAborted as t}from\"../../../../../core/promiseUtils.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/arrayUtils.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Error.js\";import{subclass as s}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{g as o,o as n}from\"../../../../../chunks/vec3.js\";import{c as i,g as r}from\"../../../../../chunks/vec3f64.js\";import{create as d,fromPoints as c,projectPoint as a}from\"../../../../../geometry/support/lineSegment.js\";import{g as p,n as u}from\"../../../../../chunks/sphere.js\";import h from\"../../../../3d/webgl-engine/lib/Octree.js\";import{extractComponentsEdgeLocationsLayout as m}from\"../../../../3d/webgl-engine/lib/edgeRendering/edgeProcessing.js\";import{maxCandidateCount as g,boundsFromEdge as l}from\"./sceneLayerSnappingUtils.js\";let _=class{constructor(){this._idToComponent=new Map,this._components=new h((e=>e.bounds)),this._edges=new h((e=>e.bounds)),this._tmpLineSegment=d(),this._tmpP1=i(),this._tmpP2=i(),this._tmpP3=i(),this.remoteClient=null}async fetchCandidates(e,s){await Promise.resolve(),t(s),await this._ensureEdgeLocations(e,s);const o=[];return this._edges.forEachNeighbor((t=>(this._addCandidates(e,t,o),o.length<g)),e.bounds),{result:{candidates:o}}}async _ensureEdgeLocations(e,t){const s=[];if(this._components.forEachNeighbor((e=>{if(null==e.info){const{id:t,uid:o}=e;s.push({id:t,uid:o})}return!0}),e.bounds),!s.length)return;const o={components:s},n=await this.remoteClient.invoke(\"fetchAllEdgeLocations\",o,t??{});for(const i of n.components)this._setFetchEdgeLocations(i)}async add(e){const t=new b(e.id,e.bounds);return this._idToComponent.set(t.id,t),this._components.add([t]),{result:{}}}async remove(e){const t=this._idToComponent.get(e.id);if(t){const e=[];this._edges.forEachNeighbor((s=>(s.component===t&&e.push(s),!0)),t.bounds),this._edges.remove(e),this._components.remove([t]),this._idToComponent.delete(t.id)}return{result:{}}}_setFetchEdgeLocations(e){const t=this._idToComponent.get(e.id);if(null==t||e.uid!==t.uid)return;const s=m.createView(e.locations),o=new Array(s.count),n=i(),r=i();for(let i=0;i<s.count;i++){s.position0.getVec(i,n),s.position1.getVec(i,r);const d=l(n,r,e.origin),c=new j(t,i,d);o[i]=c}this._edges.add(o);const{objectIds:d,origin:c}=e;t.info={locations:s,objectIds:d,origin:c}}_addCandidates(e,t,s){const{info:n}=t.component,{origin:i,objectIds:r}=n,d=n.locations,c=d.position0.getVec(t.index,this._tmpP1),a=d.position1.getVec(t.index,this._tmpP2);o(c,c,i),o(a,a,i);const p=r[d.componentIndex.get(t.index)];this._addEdgeCandidate(e,p,c,a,s),this._addVertexCandidate(e,p,c,s),this._addVertexCandidate(e,p,a,s)}_addEdgeCandidate(e,t,s,o,i){if(!e.returnEdge)return;const d=p(e.bounds),h=c(s,o,this._tmpLineSegment),m=a(h,d,this._tmpP3);u(e.bounds,m)&&i.push({type:\"edge\",objectId:t,target:r(m),distance:n(d,m),start:r(s),end:r(o)})}_addVertexCandidate(e,t,s,o){if(!e.returnVertex)return;const i=p(e.bounds);u(e.bounds,s)&&o.push({type:\"vertex\",objectId:t,target:r(s),distance:n(i,s)})}};_=e([s(\"esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker\")],_);const f=_;class b{constructor(e,t){this.id=e,this.bounds=t,this.info=null,this.uid=++b.uid}}b.uid=0;class j{constructor(e,t,s){this.component=e,this.index=t,this.bounds=s}}export{f as default};\n"],"names":["e","t","a","m","c","p","n","s","o","r","_","constructor","this","_idToComponent","Map","_components","h","bounds","_edges","_tmpLineSegment","d","_tmpP1","i","_tmpP2","_tmpP3","remoteClient","fetchCandidates","Promise","resolve","_ensureEdgeLocations","forEachNeighbor","_addCandidates","length","result","candidates","info","id","uid","push","components","invoke","_setFetchEdgeLocations","add","b","set","remove","get","component","delete","createView","locations","Array","count","position0","getVec","position1","l","origin","j","objectIds","index","componentIndex","_addEdgeCandidate","_addVertexCandidate","returnEdge","u","type","objectId","target","distance","start","end","returnVertex","f"],"sourceRoot":""}