"use strict";(self.webpackChunksc_viaduct=self.webpackChunksc_viaduct||[]).push([[2745],{82745:(e,t,r)=>{r.d(t,{Feature3DPipeline:()=>k});var n=r(35143),i=r(50076),a=r(54901),o=r(91291),s=r(68134),u=r(46053),d=(r(81806),r(76460),r(47249),r(85842)),l=r(14672),c=r(12016),p=r(76797),y=r(77725);let h=class extends o.Z{constructor(e){super(e),this.schedule=null,this._workerUpdating=!0}get updating(){return this._workerUpdating}initialize(){this._workerHandle=new w(this.schedule,this);const{layer:e,viewSpatialReference:t,renderSpatialReference:r}=this;this.addResolvingPromise((async()=>await this._workerHandle.invokeMethod("setup",{url:e.parsedUrl?.path??"",baseQuery:e.createQuery().toJSON(),viewSpatialReference:t.toJSON(),renderSpatialReference:r.toJSON(),viewingMode:this.viewingMode,objectIdField:e.objectIdField,capabilities:e.capabilities,timeInfo:e.timeInfo?.toJSON(),fieldsIndex:e.fieldsIndex.toJSON()}))()),this.addHandles(this._workerHandle.on("notify-updating",(e=>{let{updating:t}=e;this._workerUpdating=t})))}async onTileTreeChange(e){let{added:t,removed:r}=e;if(0===t.length&&0===r.length)return;const n=t.map(g),i=r.map(m);await this._workerHandle.invokeMethod("onTileTreeChange",{added:n,removed:i})}async executeQuery(e,t){const r=await this._workerHandle.invokeMethod("executeQuery",e?.toJSON(),t),n=y.A.fromJSON(r);return this._ensureLayerOnFeatures(n),n}async executeQueryForIds(e,t){return await this._workerHandle.invokeMethod("executeQueryForIds",e?.toJSON(),t)}async executeQueryForCount(e,t){return await this._workerHandle.invokeMethod("executeQueryForCount",e?.toJSON(),t)}async executeQueryForExtent(e,t){const{count:r,extent:n}=await this._workerHandle.invokeMethod("executeQueryForExtent",e?.toJSON(),t);return{count:r,extent:p.A.fromJSON(n)}}async executeQueryForLatestObservations(e,t){const r=await this._workerHandle.invokeMethod("executeQueryForLatestObservations",e?.toJSON(),t),n=y.A.fromJSON(r);return this._ensureLayerOnFeatures(n),n}_ensureLayerOnFeatures(e){const{layer:t}=this;for(const r of e.features)r.layer=t,r.sourceLayer=t}};(0,n._)([(0,u.MZ)()],h.prototype,"updating",null),(0,n._)([(0,u.MZ)({constructOnly:!0})],h.prototype,"schedule",void 0),(0,n._)([(0,u.MZ)({constructOnly:!0})],h.prototype,"layer",void 0),(0,n._)([(0,u.MZ)({constructOnly:!0})],h.prototype,"viewSpatialReference",void 0),(0,n._)([(0,u.MZ)({constructOnly:!0})],h.prototype,"renderSpatialReference",void 0),(0,n._)([(0,u.MZ)({constructOnly:!0})],h.prototype,"viewingMode",void 0),(0,n._)([(0,u.MZ)({constructOnly:!0})],h.prototype,"dispatchRenderCommands",void 0),(0,n._)([(0,u.MZ)()],h.prototype,"_workerUpdating",void 0),h=(0,n._)([(0,d.$)("esri.views.3d.layers.graphics.pipeline.Feature3DPipelineWorkerHandle")],h);class w extends c.B{constructor(e,t){super("Feature3DPipelineWorker","setup",{},e,{strategy:"dedicated",client:t})}}function g(e){let{id:t,lij:r,extent:n}=e;return{id:t,lij:r,extent:n}}function m(e){let{id:t}=e;return t}var v=r(27786),_=r(42123),f=r(65768),x=r(44513);let k=class extends o.Z{constructor(e){super(e),this._renderer=null,this.graphicsQuery={queryForSymbologySnapping:(e,t)=>{throw new i.A("unsupported-symbology-snapping")},executeQuery:async(e,t)=>await this._workerHandle.executeQuery(e,t),executeQueryForIds:async(e,t)=>await this._workerHandle.executeQueryForIds(e,t),executeQueryForCount:async(e,t)=>await this._workerHandle.executeQueryForCount(e,t),executeQueryForExtent:async(e,t)=>await this._workerHandle.executeQueryForExtent(e,t),executeQueryForLatestObservations:async(e,t)=>await this._workerHandle.executeQueryForLatestObservations(e,t)},this.maximumNumberOfFeatures=1e3}initialize(){if("point"!==this.layerView.layer.geometryType)throw new i.A("unsupported-geometry-type",`${this.layerView.layer.geometryType} is not supported`);this.addResolvingPromise(this.setup())}async setup(){const{layer:e,view:t}=this.layerView,{spatialReference:r,renderSpatialReference:n,resourceController:i}=t,a=t.state.viewingMode;if(this._renderer=new v.i3({view:t,layerUid:e.uid}),"feature"!==e.type)throw new Error("Only FeatureLayer is supported");const o=new h({schedule:e=>i.immediate.schedule(e),layer:e,viewSpatialReference:r,renderSpatialReference:n,viewingMode:a,dispatchRenderCommands:e=>this._renderer.executeRenderCommands(e)});this._workerHandle=await o.when(),this.addHandles([this.layerView.view.featureTiles.addClient(),(0,s.on)((()=>this.layerView.view.featureTiles.tiles),"change",(e=>{this._workerHandle.onTileTreeChange(e)}),{onListenerAdd:e=>this._workerHandle.onTileTreeChange({added:e.toArray(),removed:[]}),onListenerRemove:e=>this._workerHandle.onTileTreeChange({added:[],removed:e.toArray()})})])}get legendEnabled(){return!1}get hasAllFeatures(){return!1}get hasAllFeaturesInView(){return!1}get hasFullGeometries(){return!1}get symbologySnappingSupported(){return!1}get scaleVisibilitySuspended(){return!1}get suspendInfo(){return{}}get updating(){return this._workerHandle.updating}get dataUpdating(){return!1}get updatePolicy(){return x.q.ASYNC}get maximumNumberOfFeaturesExceeded(){return!1}get updatingProgressValue(){return 1}get usedMemory(){return 100}get unloadedMemory(){return 0}get ignoresMemoryFactor(){return!0}get performanceInfo(){return new l.X(new f.P(this.usedMemory,0,0,this.maximumNumberOfFeatures,0,null),0,0,!0,"tiles","n/a")}get suspendResumeExtentMode(){return"computed"}forEachGraphic(e){}findGraphic(e){return null}highlight(e){return _.Wg}maskOccludee(e){return(0,a.hA)()}async whenGraphicBounds(e,t){return null}computeAttachmentOrigin(e,t){return null}elevationAlignPointsInFeatures(e,t){throw new i.A("unsupported-elevation-alignment")}async doRefresh(e){}setVisibility(e,t){}getMissingAttributesForFeature(e){return null}getHydratedGeometry(e){return null}};(0,n._)([(0,u.MZ)()],k.prototype,"layerView",void 0),(0,n._)([(0,u.MZ)()],k.prototype,"updating",null),k=(0,n._)([(0,d.$)("esri.views.3d.layers.graphics.pipeline.Feature3DPipeline")],k)}}]);
//# sourceMappingURL=2745.0b117585.chunk.js.map