{"version":3,"file":"static/js/1734.dfd7e419.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/libs/i3s/enums.js","../node_modules/@arcgis/core/libs/i3s/I3SModule.js","../node_modules/@arcgis/core/views/3d/layers/SceneLayerWorker.js","../node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nvar n,e;!function(n){n[n.None=0]=\"None\",n[n.Int16=1]=\"Int16\",n[n.Int32=2]=\"Int32\"}(n||(n={})),function(n){n[n.Replace=0]=\"Replace\",n[n.Outside=1]=\"Outside\",n[n.Inside=2]=\"Inside\",n[n.Finished=3]=\"Finished\"}(e||(e={}));export{n as IndexType,e as ModificationType};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as t}from\"../../assets.js\";function e(){return n||(n=new Promise((t=>import(\"../../chunks/i3s.js\").then((t=>t.i)).then((({default:e})=>{const n=e({locateFile:i,onRuntimeInitialized:()=>t(n)});delete n.then})))).catch((t=>{throw t}))),n}function i(e){return t(`esri/libs/i3s/${e}`)}let n;export{e as get};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{hasScaling as e}from\"../../../core/mathUtils.js\";import t from\"../../../geometry/SpatialReference.js\";import r from\"../../../geometry/support/MeshGeoreferencedVertexSpace.js\";import o from\"../../../geometry/support/MeshLocalVertexSpace.js\";import{b as n,n as s}from\"../../../chunks/vec3.js\";import{IndexType as i}from\"../../../libs/i3s/enums.js\";import{get as a}from\"../../../libs/i3s/I3SModule.js\";import{NodeIMModificationImpact as f}from\"./i3s/I3SNode.js\";async function c(e){g=await S();const t=[e.geometryBuffer];return{result:E(g,e,t),transferList:t}}async function l(e){g=await S();const t=[e.geometryBuffer],{geometryBuffer:r}=e,o=r.byteLength,n=g._malloc(o),s=new Uint8Array(g.HEAPU8.buffer,n,o);s.set(new Uint8Array(r));const i=g.dracoDecompressPointCloudData(n,s.byteLength);if(g._free(n),i.error.length>0)throw new Error(`i3s.wasm: ${i.error}`);const a=i.featureIds?.length>0?i.featureIds.slice():null,f=i.positions.slice();return a&&t.push(a.buffer),t.push(f.buffer),{result:{positions:f,featureIds:a},transferList:t}}async function u(e){await S(),j(e);const t={buffer:e.buffer};return{result:t,transferList:[t.buffer]}}async function m(e){await S(),w(e)}async function y(e){g=await S(),g.setLegacySchema(e.context,e.jsonSchema)}async function p(e){const{localMatrix:n,origin:s,positions:i,vertexSpace:a}=e,f=t.fromJSON(e.inSpatialReference),c=t.fromJSON(e.outSpatialReference);let l;const[{projectBuffer:u},{initializeProjection:m}]=await Promise.all([import(\"../../../geometry/projection/projectBuffer.js\"),import(\"../../../geometry/projection.js\")]);await m(f,c);const y=[0,0,0];if(!u(s,f,0,y,c,0))throw new Error(\"Failed to project\");if(\"georeferenced\"===a.type&&null==a.origin){if(l=new Float64Array(i.length),!u(i,f,0,l,c,0,l.length/3))throw new Error(\"Failed to project\")}else{const e=\"georeferenced\"===a.type?r.fromJSON(a):o.fromJSON(a),{projectMeshVertexPositions:t}=await import(\"../../../geometry/support/meshUtils/projectMeshVertexPositions.js\"),s=t({vertexAttributes:{position:i},transform:n?{localMatrix:n}:void 0,vertexSpace:e,spatialReference:f},c);if(!s)throw new Error(\"Failed to project\");l=s}const p=l.length,[d,h,b]=y;for(let t=0;t<p;t+=3)l[t]-=d,l[t+1]-=h,l[t+2]-=b;return{result:{projected:l,original:i,projectedOrigin:y},transferList:[l.buffer,i.buffer]}}async function d({normalMatrix:t,normals:r}){const o=new Float32Array(r.length);return n(o,r,t),e(t)&&s(o,o),{result:{transformed:o,original:r},transferList:[o.buffer,r.buffer]}}function h(e){L(e)}let b,g;function w(e){if(!g)return;const t=e.modifications,r=g._malloc(8*t.length),o=new Float64Array(g.HEAPU8.buffer,r,t.length);for(let n=0;n<t.length;++n)o[n]=t[n];g.setModifications(e.context,r,t.length,e.isGeodetic),g._free(r)}function E(e,t,r){const{context:o,globalTrafo:n,mbs:s,obbData:a,elevationOffset:f,geometryBuffer:c,geometryDescriptor:l,indexToVertexProjector:u,vertexToRenderProjector:m}=t,y=e._malloc(c.byteLength),p=33,d=e._malloc(p*Float64Array.BYTES_PER_ELEMENT),h=new Uint8Array(e.HEAPU8.buffer,y,c.byteLength);h.set(new Uint8Array(c));const b=new Float64Array(e.HEAPU8.buffer,d,p);I(b,[NaN,NaN,NaN]);let g=b.byteOffset+3*b.BYTES_PER_ELEMENT,w=new Float64Array(b.buffer,g);I(w,n),g+=16*b.BYTES_PER_ELEMENT,w=new Float64Array(b.buffer,g),I(w,s),g+=4*b.BYTES_PER_ELEMENT,a&&(w=new Float64Array(b.buffer,g),I(w,a));const E=l,A={isDraco:!1,isLegacy:!1,color:t.layouts.some((e=>e.some((e=>\"color\"===e.name)))),normal:t.needNormals&&t.layouts.some((e=>e.some((e=>\"normalCompressed\"===e.name)))),uv0:t.layouts.some((e=>e.some((e=>\"uv0\"===e.name)))),uvRegion:t.layouts.some((e=>e.some((e=>\"uvRegion\"===e.name)))),featureIndex:E.featureIndex},j=e.process(o,!!t.obbData,y,h.byteLength,E,A,d,f,u,m,t.normalReferenceFrame);if(e._free(d),e._free(y),j.error.length>0)throw new Error(`i3s.wasm: ${j.error}`);if(j.discarded)return null;const L=j.componentOffsets.length>0?j.componentOffsets.slice():null,x=j.featureIds.length>0?j.featureIds.slice():null,S=j.anchorIds.length>0?Array.from(j.anchorIds):null,_=j.anchors.length>0?Array.from(j.anchors):null,P=j.interleavedVertedData.slice().buffer,M=j.indicesType===i.Int16?new Uint16Array(j.indices.buffer,j.indices.byteOffset,j.indices.byteLength/2).slice():new Uint32Array(j.indices.buffer,j.indices.byteOffset,j.indices.byteLength/4).slice(),N=j.positions.slice(),U=j.positionIndicesType===i.Int16?new Uint16Array(j.positionIndices.buffer,j.positionIndices.byteOffset,j.positionIndices.byteLength/2).slice():new Uint32Array(j.positionIndices.buffer,j.positionIndices.byteOffset,j.positionIndices.byteLength/4).slice(),T={layout:t.layouts[0],interleavedVertexData:P,indices:M,hasColors:j.hasColors,hasModifications:j.hasModifications,positionData:{data:N,indices:U}};return x&&r.push(x.buffer),L&&r.push(L.buffer),r.push(P),r.push(M.buffer),r.push(N.buffer),r.push(U.buffer),{componentOffsets:L,featureIds:x,anchorIds:S,anchors:_,transformedGeometry:T,obb:j.obb,globalTrafo:n}}function A(e){return 0===e?f.Unmodified:1===e?f.PotentiallyModified:2===e?f.Culled:f.Unknown}function j(e){if(!g)return;const{context:t,buffer:r}=e,o=g._malloc(r.byteLength),n=r.byteLength/Float64Array.BYTES_PER_ELEMENT,s=new Float64Array(g.HEAPU8.buffer,o,n),i=new Float64Array(r);s.set(i),g.filterOBBs(t,o,n),i.set(s),g._free(o)}function L(e){g&&0===g.destroy(e)&&(g=null)}function I(e,t){for(let r=0;r<t.length;++r)e[r]=t[r]}async function x(){g||await S()}function S(){return g?Promise.resolve(g):(b||(b=a().then((e=>(g=e,b=null,g)))),b)}const _={transform:(e,t)=>g&&E(g,e,t),destroy:L};export{h as destroyContext,l as dracoDecompressPointCloudData,u as filterObbsForModifications,j as filterObbsForModificationsSync,x as initialize,A as interpretObbModificationResults,c as process,p as project,y as setLegacySchema,m as setModifications,w as setModificationsSync,_ as test,d as transformNormals};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromValues as e}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{f as i}from\"../../../../chunks/sphere.js\";import{invalidateMbs as n}from\"./I3SUtil.js\";import{ElevationRange as t}from\"../../support/ElevationRange.js\";class s extends t{constructor(e,n){super(NaN,NaN),this.id=e,this.serviceMbsInIndexSR=n,this.serviceMbsInRenderSR=i(0,0,0,-1)}invalidateServiceBVsInRenderSR(){n(this.serviceMbsInRenderSR),this.serviceObbInRenderSR?.invalidate()}shareServiceBVsInRenderSRWith(e){this.serviceObbInRenderSR=e.serviceObbInRenderSR,this.serviceMbsInRenderSR=e.serviceMbsInRenderSR}}var o,r,a,d,c;!function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.Culled=1]=\"Culled\",e[e.NotChecked=2]=\"NotChecked\"}(o||(o={})),function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.PotentiallyModified=1]=\"PotentiallyModified\",e[e.Culled=2]=\"Culled\",e[e.Unknown=3]=\"Unknown\",e[e.NotChecked=4]=\"NotChecked\"}(r||(r={}));class h extends s{constructor(i,n,t,s,o,d,c,h,l,u){super(i,t),this.index=n,this.childCount=s,this.level=o,this.resources=d,this.version=c,this.lodMetric=h,this.maxError=l,this.numFeatures=u,this.failed=!1,this.cacheState=a.Unknown,this.vertexCount=0,this.memory=0,this.childrenLoaded=0,this.hasModifications=!1,this.imModificationImpact=r.NotChecked,this.elevationAgnosticBoundingVolume=e(0,0,0,-1)}invalidateServiceBVsInRenderSR(){super.invalidateServiceBVsInRenderSR(),this.elevationAgnosticBoundingVolume[3]=-1}}!function(e){e[e.Unknown=0]=\"Unknown\",e[e.Uncached=1]=\"Uncached\",e[e.Cached=2]=\"Cached\"}(a||(a={})),function(e){e[e.None=0]=\"None\",e[e.MaxScreenThreshold=1]=\"MaxScreenThreshold\",e[e.ScreenSpaceRelative=2]=\"ScreenSpaceRelative\",e[e.RemovedFeatureDiameter=3]=\"RemovedFeatureDiameter\",e[e.DistanceRangeFromDefaultCamera=4]=\"DistanceRangeFromDefaultCamera\"}(d||(d={})),function(e){e[e.Hole=0]=\"Hole\",e[e.Leaf=1]=\"Leaf\"}(c||(c={}));class l{constructor(e,i,n,t){this.nodeHasLOD=e,this.isChosen=i,this.lodLevel=n,this.version=t}}export{a as CacheState,d as LodMetric,h as Node,s as NodeBase,o as NodeFilterImpact,r as NodeIMModificationImpact,c as NodeState,l as NodeTraversalState};\n"],"names":["n","e","None","Int16","Int32","Replace","Outside","Inside","Finished","i","t","concat","async","c","g","S","geometryBuffer","result","E","transferList","l","_i$featureIds","r","o","byteLength","_malloc","s","Uint8Array","HEAPU8","buffer","set","dracoDecompressPointCloudData","_free","error","length","Error","a","featureIds","slice","f","positions","push","u","j","m","w","y","setLegacySchema","context","jsonSchema","p","localMatrix","origin","vertexSpace","fromJSON","inSpatialReference","outSpatialReference","projectBuffer","initializeProjection","Promise","all","type","Float64Array","projectMeshVertexPositions","vertexAttributes","position","transform","spatialReference","d","h","b","projected","original","projectedOrigin","_ref","normalMatrix","normals","Float32Array","transformed","L","modifications","setModifications","isGeodetic","globalTrafo","mbs","obbData","elevationOffset","geometryDescriptor","indexToVertexProjector","vertexToRenderProjector","BYTES_PER_ELEMENT","I","NaN","byteOffset","A","isDraco","isLegacy","color","layouts","some","name","normal","needNormals","uv0","uvRegion","featureIndex","process","normalReferenceFrame","discarded","componentOffsets","x","anchorIds","Array","from","_","anchors","P","interleavedVertedData","M","indicesType","Uint16Array","indices","Uint32Array","N","U","positionIndicesType","positionIndices","T","layout","interleavedVertexData","hasColors","hasModifications","positionData","data","transformedGeometry","obb","Unmodified","PotentiallyModified","Culled","Unknown","filterOBBs","destroy","resolve","then","default","locateFile","onRuntimeInitialized","catch","constructor","super","this","id","serviceMbsInIndexSR","serviceMbsInRenderSR","invalidateServiceBVsInRenderSR","_this$serviceObbInRen","serviceObbInRenderSR","invalidate","shareServiceBVsInRenderSRWith","NotChecked","index","childCount","level","resources","version","lodMetric","maxError","numFeatures","failed","cacheState","vertexCount","memory","childrenLoaded","imModificationImpact","elevationAgnosticBoundingVolume","Uncached","Cached","MaxScreenThreshold","ScreenSpaceRelative","RemovedFeatureDiameter","DistanceRangeFromDefaultCamera","Hole","Leaf","nodeHasLOD","isChosen","lodLevel"],"sourceRoot":""}