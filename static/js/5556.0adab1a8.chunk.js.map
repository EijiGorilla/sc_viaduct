{"version":3,"file":"static/js/5556.0adab1a8.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/layers/ImageryLayerView.js","../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import s from\"../../geometry/Point.js\";import{combinedViewLayerTimeExtentProperty as p}from\"../../layers/support/commonProperties.js\";import i from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as a}from\"./support/popupUtils.js\";const n=n=>{let u=class extends n{constructor(){super(...arguments),this.view=null}async fetchPopupFeatures(e,t){const{layer:o}=this;if(!e)throw new r(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:o});const{popupEnabled:p}=o,n=a(o,t);if(!p||null==n)throw new r(\"imagerylayerview:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:p,popupTemplate:n});const u=await n.getRequiredFields(),l=new i;l.timeExtent=this.timeExtent,l.geometry=e,l.outFields=u,l.outSpatialReference=e.spatialReference;const{resolution:m,spatialReference:c}=this.view,y=\"2d\"===this.view.type?new s(m,m,c):new s(.5*m,.5*m,c),{returnTopmostRaster:d,showNoDataRecords:h}=n.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},w={returnDomainValues:!0,returnTopmostRaster:d,pixelSize:y,showNoDataRecords:h,signal:null!=t?t.signal:null};return o.queryVisibleRasters(l,w).then((e=>e))}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([t()],u.prototype,\"layer\",void 0),e([t()],u.prototype,\"suspended\",void 0),e([t(p)],u.prototype,\"timeExtent\",void 0),e([t()],u.prototype,\"view\",void 0),u=e([o(\"esri.views.layers.ImageryLayerView\")],u),u};export{n as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as t}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/Error.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DynamicLayerView3D.js\";import s from\"../../layers/ImageryLayerView.js\";let o=class extends(s(r)){constructor(){super(...arguments),this.type=\"imagery-3d\",this.redrawDebounced=a((async e=>{this.redraw(((e,a)=>this._redrawImage(e,a)),e)}),2e3)}initialize(){this.addHandles([t((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on(\"redraw\",(()=>this._updatingHandles.addPromise(this.redrawDebounced())))]),this._updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.layer?.renderer),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.timeExtent),(()=>this._updatingHandles.addPromise(this.refreshDebounced())))}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,a,t){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,t))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const t=e.image,i=t.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:a}),s=this.layer.applyFilter(r).pixelBlock;if(null==s)throw new Error;t.width=s.width,t.height=s.height;const o=i.createImageData(s.width,s.height);o.data.set(s.getAsRGBA()),i.putImageData(o,0,0)}};o=e([i(\"esri.views.3d.layers.ImageryLayerView3D\")],o);const n=o;export{n as default};\n"],"names":["n","u","constructor","super","arguments","this","view","fetchPopupFeatures","e","t","layer","o","r","popupEnabled","p","a","popupTemplate","getRequiredFields","l","i","timeExtent","geometry","outFields","outSpatialReference","spatialReference","resolution","m","c","y","type","s","returnTopmostRaster","d","showNoDataRecords","h","layerOptions","w","returnDomainValues","pixelSize","signal","queryVisibleRasters","then","canResume","_this$timeExtent","isEmpty","prototype","redrawDebounced","async","redraw","_redrawImage","initialize","addHandles","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","on","_updatingHandles","addPromise","add","_this$layer","exportImageServiceParameters","version","refreshDebounced","_this$layer2","renderer","maximumDataResolution","loaded","serviceRasterInfo","getFetchOptions","processResult","imageOrCanvasElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","getContext","applyRenderer","applyFilter","pixelBlock","width","height","createImageData","data","set","getAsRGBA","putImageData"],"sourceRoot":""}