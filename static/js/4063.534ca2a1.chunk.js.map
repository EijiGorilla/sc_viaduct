{"version":3,"file":"static/js/4063.534ca2a1.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/PointCloudWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../core/arrayUtils.js\";import{isArrayBuffer as r}from\"../../../core/typedArrayUtil.js\";import{a as e}from\"../../../chunks/quat.js\";import{a}from\"../../../chunks/quatf64.js\";import{v as o}from\"../../../chunks/vec3.js\";import{f as n,c as f}from\"../../../chunks/vec3f32.js\";import i from\"../../../geometry/SpatialReference.js\";import{projectBuffer as s}from\"../../../geometry/projection/projectBuffer.js\";import{readGeometry as u,getAttributeValues as l,evaluateRenderer as b,filterInPlace as m}from\"./i3s/PointCloudWorkerUtil.js\";class p{transform(t){const e=this._transform(t),a=[e.points.buffer,e.rgb.buffer];null!=e.pointIdFilterMap&&a.push(e.pointIdFilterMap.buffer);for(const o of e.attributes)\"buffer\"in o.values&&r(o.values.buffer)&&o.values.buffer!==e.rgb.buffer&&a.push(o.values.buffer);return Promise.resolve({result:e,transferList:a})}_transform(r){const e=u(r.schema,r.geometryBuffer);let a=e.length/3,o=null;const n=new Array,f=l(r.primaryAttributeData,e,a);null!=r.primaryAttributeData&&f&&n.push({attributeInfo:r.primaryAttributeData.attributeInfo,values:f});const s=l(r.modulationAttributeData,e,a);null!=r.modulationAttributeData&&s&&n.push({attributeInfo:r.modulationAttributeData.attributeInfo,values:s});let p=b(r.rendererInfo,f,s,a);if(r.filterInfo&&r.filterInfo.length>0&&null!=r.filterAttributesData){const f=r.filterAttributesData.filter(t).map((t=>{const r=l(t,e,a),o={attributeInfo:t.attributeInfo,values:r};return n.push(o),o}));o=new Uint32Array(a),a=m(e,p,o,r.filterInfo,f)}for(const t of r.userAttributesData){const r=l(t,e,a);n.push({attributeInfo:t.attributeInfo,values:r})}3*a<p.length&&(p=new Uint8Array(p.buffer.slice(0,3*a))),this._applyElevationOffsetInPlace(e,a,r.elevationOffset);const c=this._transformCoordinates(e,a,r.obb,i.fromJSON(r.inSR),i.fromJSON(r.outSR));return{obb:r.obb,points:c,rgb:p,attributes:n,pointIdFilterMap:o}}_transformCoordinates(t,r,a,i,u){if(!s(t,i,0,t,u,0,r))throw new Error(\"Can't reproject\");const l=n(a.center[0],a.center[1],a.center[2]),b=f(),m=f();e(c,a.quaternion);const p=new Float32Array(3*r);for(let e=0;e<r;e++)b[0]=t[3*e]-l[0],b[1]=t[3*e+1]-l[1],b[2]=t[3*e+2]-l[2],o(m,b,c),a.halfSize[0]=Math.max(a.halfSize[0],Math.abs(m[0])),a.halfSize[1]=Math.max(a.halfSize[1],Math.abs(m[1])),a.halfSize[2]=Math.max(a.halfSize[2],Math.abs(m[2])),p[3*e]=b[0],p[3*e+1]=b[1],p[3*e+2]=b[2];return p}_applyElevationOffsetInPlace(t,r,e){if(0!==e)for(let a=0;a<r;a++)t[3*a+2]+=e}}const c=a();function h(){return new p}export{h as default};\n"],"names":["p","transform","t","e","this","_transform","a","points","buffer","rgb","pointIdFilterMap","push","o","attributes","values","r","Promise","resolve","result","transferList","u","schema","geometryBuffer","length","n","Array","f","l","primaryAttributeData","attributeInfo","s","modulationAttributeData","b","rendererInfo","filterInfo","filterAttributesData","filter","map","Uint32Array","m","userAttributesData","Uint8Array","slice","_applyElevationOffsetInPlace","elevationOffset","c","_transformCoordinates","obb","i","fromJSON","inSR","outSR","Error","center","quaternion","Float32Array","halfSize","Math","max","abs","h"],"sourceRoot":""}