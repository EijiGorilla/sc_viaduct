{"version":3,"file":"static/js/8675.6ea26c97.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/symbols/cim/CIMResourceManager.js","../node_modules/@arcgis/core/symbols/cim/CIMSymbolRasterizer.js","../node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{loadFont as e}from\"../../core/fontUtils.js\";import{getImageData as t}from\"../../core/imageUtils.js\";class i{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,i){const h=this._resourceMap.get(e);if(h)return{width:h.width,height:h.height};let r=this._inFlightResourceMap.get(e);return r?r.then((e=>({width:e.width,height:e.height}))):(r=t(e,i),this._inFlightResourceMap.set(e,r),r.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(t){return e(t)}}export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"./CIMResourceManager.js\";import{Transformation as t,CanvasDrawHelper as i}from\"./CIMSymbolDrawHelper.js\";import{CIMSymbolHelper as r}from\"./CIMSymbolHelper.js\";import{OverrideHelper as a}from\"./OverrideHelper.js\";import{mapCIMSymbolToGeometryType as s}from\"./utils.js\";const n=96/72;class h{constructor(t){this._spatialReference=t,this._imageDataCanvas=null,this._cimResourceManager=new e}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement(\"canvas\")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,i,n,h,l,c,m,g){if(!e)return null;const{data:y}=e;if(!y||\"CIMSymbolReference\"!==y.type||!y.symbol)return null;const{symbol:d}=y;l||(l=s(d));const u=await a.resolveSymbolOverrides(y,t,this._spatialReference,h,l,c,m),w=this._cimResourceManager,p=[];r.fetchResources(u,w,p),r.fetchFonts(u,w,p),p.length>0&&await Promise.all(p);const{width:b,height:f}=i,M=o(l,b,f,n),C=r.getEnvelope(u,M,w);if(!C)return null;C.x===1/0&&(C.x=b+2),C.y===1/0&&(C.y=-f/2),C.width===-1/0&&(C.width=b),C.height===-1/0&&(C.height=f);let R=1,v=0,x=0;switch(d.type){case\"CIMPointSymbol\":case\"CIMTextSymbol\":{let e=1;C.width>b&&(e=b/C.width);let t=1;C.height>f&&(t=f/C.height),\"preview\"===n&&(C.width<b&&(e=b/C.width),C.height<f&&(t=f/C.height)),R=Math.min(e,t),v=C.x+C.width/2,x=C.y+C.height/2}break;case\"CIMLineSymbol\":{(g||C.height>f)&&(R=f/C.height),x=C.y+C.height/2;const e=C.x*R+b/2,t=(C.x+C.width)*R+b/2,{paths:i}=M;i[0][0][0]-=e/R,i[0][2][0]-=(t-b)/R}break;case\"CIMPolygonSymbol\":{v=C.x+C.width/2,x=C.y+C.height/2;const e=C.x*R+b/2,t=(C.x+C.width)*R+b/2,i=C.y*R+f/2,r=(C.y+C.height)*R+f/2,{rings:a}=M;e<0&&(a[0][0][0]-=e,a[0][3][0]-=e,a[0][4][0]-=e),i<0&&(a[0][0][1]+=i,a[0][1][1]+=i,a[0][4][1]+=i),t>b&&(a[0][1][0]-=t-b,a[0][2][0]-=t-b),r>f&&(a[0][2][1]+=r-f,a[0][3][1]+=r-f)}}const I={type:\"cim\",data:{type:\"CIMSymbolReference\",symbol:u}};return this.rasterize(I,b,f,v,x,R,l,1,M)}rasterize(e,r,a,h,l,c,m,g=0,y=null){const{data:d}=e;if(!d||\"CIMSymbolReference\"!==d.type||!d.symbol)return null;const{symbol:u}=d,w=this._canvas,p=(window.devicePixelRatio||1)*n;w.width=r*p,w.height=a*p,m||(m=s(u)),y||(y=o(m,r,a,\"legend\")),w.width+=2*g,w.height+=2*g;const b=w.getContext(\"2d\",{willReadFrequently:!0}),f=t.createIdentity();f.translate(-h,-l),f.scale(c*p,-c*p),f.translate(r*p/2+g,a*p/2+g),b.clearRect(0,0,w.width,w.height);return new i(b,this._cimResourceManager,f,!0).drawSymbol(u,y),b.getImageData(0,0,w.width,w.height)}}function o(e,t,i,r){const a=1,s=-t/2+a,n=t/2-a,h=i/2-a,o=-i/2+a;switch(e){case\"esriGeometryPoint\":return{x:0,y:0};case\"esriGeometryPolyline\":return{paths:[[[s,0],[0,0],[n,0]]]};default:return\"legend\"===r?{rings:[[[s,h],[n,0],[n,o],[s,o],[s,h]]]}:{rings:[[[s,h],[n,h],[n,o],[s,o],[s,h]]]}}}export{h as CIMSymbolRasterizer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{px2pt as e,pt2px as t}from\"../../core/screenUtils.js\";import{CIMSymbolHelper as i}from\"../cim/CIMSymbolHelper.js\";import{CIMSymbolRasterizer as l}from\"../cim/CIMSymbolRasterizer.js\";import{OverrideHelper as r}from\"../cim/OverrideHelper.js\";import{mapCIMSymbolToGeometryType as n}from\"../cim/utils.js\";import{SymbolSizeDefaults as a}from\"./previewUtils.js\";import{renderSymbol as o}from\"./renderUtils.js\";const s=new l(null),c=e(a.size),m=e(a.maxSize),u=e(a.lineWidth),f=1;async function h(e,t,i){const l=t?.size;let r=null!=l&&\"object\"==typeof l&&\"width\"in l?l.width:l,n=null!=l&&\"object\"==typeof l&&\"height\"in l?l.height:l;if(null==r||null==n)if(\"esriGeometryPolygon\"===i)r=c,n=c;else{const l=await y(e,t,i);l&&(r=l.width,n=l.height),\"esriGeometryPolyline\"===i&&(r=u),r=null!=r&&isFinite(r)?Math.min(r,m):c,n=null!=n&&isFinite(n)?Math.max(Math.min(n,m),f):c}return\"legend\"===t.style&&\"esriGeometryPolyline\"===i&&(r=u),{width:r,height:n}}async function y(e,t,l){const{feature:n,fieldMap:a,viewParams:o}=t.cimOptions||t,c=await r.resolveSymbolOverrides(e.data,n,null,a,l,null,o);if(!c)return null;(e=e.clone()).data={type:\"CIMSymbolReference\",symbol:c},e.data.primitiveOverrides=void 0;const m=[];return i.fetchResources(c,s.resourceManager,m),i.fetchFonts(c,s.resourceManager,m),m.length>0&&await Promise.all(m),i.getEnvelope(c,null,s.resourceManager)}async function p(e,i={}){const{node:l,opacity:r,symbolConfig:a}=i,c=null!=a&&\"object\"==typeof a&&\"isSquareFill\"in a&&a.isSquareFill,m=i.cimOptions||i,u=m.geometryType||n(e?.data?.symbol),f=await h(e,i,u),{feature:y,fieldMap:p}=m,d=c||\"esriGeometryPolygon\"!==u?\"preview\":\"legend\",g=await s.rasterizeCIMSymbolAsync(e,y,f,d,p,u,null,m.viewParams,m.allowScalingUp);if(!g)return null;const{width:w,height:b}=g,v=document.createElement(\"canvas\");v.width=w,v.height=b;v.getContext(\"2d\").putImageData(g,0,0);const M=t(f.width),j=t(f.height),S=new Image(M,j);S.src=v.toDataURL(),S.ariaLabel=i.ariaLabel??null,S.alt=i.ariaLabel??\"\",null!=r&&(S.style.opacity=`${r}`);let C=S;if(null!=i.effectView){const e={shape:{type:\"image\",x:0,y:0,width:M,height:j,src:S.src},fill:null,stroke:null,offset:[0,0]};C=o([[e]],[M,j],{effectView:i.effectView,ariaLabel:i.ariaLabel})}return l&&C&&l.appendChild(C),C}export{p as previewCIMSymbol};\n"],"names":["i","constructor","this","_resourceMap","Map","_inFlightResourceMap","geometryEngine","geometryEnginePromise","destroy","clear","getResource","e","_this$_resourceMap$ge","get","fetchResource","h","width","height","r","then","t","set","delete","deleteResource","loadFont","_spatialReference","_imageDataCanvas","_cimResourceManager","_canvas","document","createElement","resourceManager","rasterizeCIMSymbolAsync","n","l","c","m","g","data","y","type","symbol","d","s","u","a","resolveSymbolOverrides","w","p","fetchResources","fetchFonts","length","Promise","all","b","f","M","o","C","getEnvelope","x","R","v","Math","min","paths","rings","I","rasterize","arguments","undefined","window","devicePixelRatio","getContext","willReadFrequently","createIdentity","translate","scale","clearRect","drawSymbol","getImageData","size","maxSize","lineWidth","async","feature","fieldMap","viewParams","cimOptions","clone","primitiveOverrides","isFinite","max","style","_e$data","_i$ariaLabel","_i$ariaLabel2","node","opacity","symbolConfig","isSquareFill","geometryType","allowScalingUp","putImageData","j","S","Image","src","toDataURL","ariaLabel","alt","concat","effectView","shape","fill","stroke","offset","appendChild"],"sourceRoot":""}